"""
Common defines and item formatting for CSI Alerts
"""
from datetime import datetime

# instance records

DOMAIN = 6
DBID = 5
APPNAME = 4
APPID = 3
RKEY = 2
LKEY = 1
ACCTNAME = 0
# issue records
ISTATUS = 0
ITYPE = 1
ISUBTYPE = 2
INOTES = 3
ISTDATE = 4
ISTTIME = 5
IVENDOR = 6
IVENDID = 7
IVPHONE = 8
IROLENAME = 9
IRID = 10
IRETAILER = 11
ISITEID = 12
ISITENAME = 13
IADDR1 = 14
IADDR2 = 15
ICITY = 16
ISTATE = 17
IZIP = 18
ICONTACTINFO = 19
IKEYACCOUNT = 20
IRUNID = 21
ISITYPEID = 22
ISITYPE = 23
IREASONID = 24
IREASON = 25
IORIGDATE = 26
IMFGID = 27
IMFGNAME = 28
IRRID = 29
IRRNAME = 30
IWOID = 31
IWEBDIR = 32
IPREFIX = 33
IFNAME = 34
IEXT = 35


def format_item(conf, rec, runid):
    # data transforms
    dtm = datetime.combine(rec[ISTDATE], rec[ISTTIME])
    dte = f'{dtm.month:02}{dtm.day:02}{dtm.year}{dtm.hour:02}{dtm.minute:02}'
    nts = rec[INOTES].split('.')
                
    return {
            "id": f"{conf['rec'][APPID]}-{rec[IWOID]}-{dte}",
            "created_at": dtm.isoformat(),
            "runid": rec[IRUNID],
            "notes": rec[INOTES],
            "status": "Active",
            "type": {
                "id": rec[ISITYPEID],
                "text": rec[ISITYPE]
            },
            "reason": {
                "id": rec[IREASONID],
                "text": rec[IREASON]
            },
            "store": {
                "id": rec[ISITEID],
                "name": rec[ISITENAME],
                "address": rec[IADDR1],
                "city": rec[ICITY],
                "state": rec[ISTATE],
                "zip": rec[IZIP],
                "phone": rec[ICONTACTINFO]
            },
            "banner": {
                "id": rec[IRID],
                "name": rec[IRETAILER]
            },
            "retailer": {
                "id": rec[IRRID],
                "name": rec[IRRNAME]
            },
            "vendor": {
                "id": rec[IVENDID],
                "name": rec[IVENDOR],
                "number": rec[IVPHONE]
            },
            "manufacturer": {
                "id": rec[IMFGID],
                "name": rec[IMFGNAME]
            },
            "photos": []
        }